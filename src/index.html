<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Hyperledger Fabric Simple Control Panel</title>
    <script src="./node_modules/@webcomponents/webcomponentsjs/webcomponents-loader.js"></script>
    <script type="module">
      // Import modules
      import '@material/mwc-button';
      import '@material/mwc-list/mwc-list.js';
      import '@material/mwc-list/mwc-list-item.js';
      import '@material/mwc-top-app-bar-fixed';
      import '@material/mwc-tab-bar';
      import '@material/mwc-tab';
      import '@material/mwc-textfield';
      import '@material/mwc-icon';
      import 'mustache';
      window['$scp_state'] = {};
      window['$scp_component'] = {};
      window.dispatchStateChange = (component, payload) => {
        const event = document.createEvent('Event');
        event.initEvent('state_change_render', true, true);
        event.payload = payload;
        component.dispatchEvent(event);
      }
      // global state change event handler
      window.addEventListener('state_change_render', (res) => {
        res.target.render();
        Object.keys(window.$scp_component).forEach((componentName) => {
          if (window.$scp_component[componentName].trigger) {
            window.$scp_component[componentName].trigger(res.target.name, res.payload)
          }
        });
        // window.$scp_component.render({selectedChannel: res.payload});
      });
      // import components
      const head = document.querySelector('head');
      [
        './src/components/scp-env-tabs.js', 
        './src/components/scp-channel-list.js',
        './src/components/scp-peer-list.js', 
        './src/components/scp-peer-detail.js',
        './src/index.js'
      ].forEach((p) => {
        const script = document.createElement('script');
        script.src = p;
        head.appendChild(script)
      });
    </script>
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Material+Icons&display=block" rel="stylesheet">
    <style>
      body {
        margin: 0;
        padding: 0;
      }
      p, h1, h2, h3, span, b, span, i {
        color: #eaeaea;
        margin: 0;
      }
    </style>
  </head>
  <body>
    <scp-main></scp-main>
    
  </body>
</html>
